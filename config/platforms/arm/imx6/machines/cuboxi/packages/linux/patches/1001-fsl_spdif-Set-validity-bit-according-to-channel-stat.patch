From 2905ca63185ec7db94f24dc8f0d14d48be13e760 Mon Sep 17 00:00:00 2001
From: Rudi <r.ihle@s-t.de>
Date: Sat, 2 Aug 2014 20:21:28 +0200
Subject: [PATCH 1001/1005] fsl_spdif: Set validity bit according to channel
 status

Signed-off-by: Rudi <r.ihle@s-t.de>
---
 sound/soc/fsl/fsl_spdif.c |    4 ++++
 1 file changed, 4 insertions(+)

diff --git a/sound/soc/fsl/fsl_spdif.c b/sound/soc/fsl/fsl_spdif.c
index 80aeb7f..0c97096 100644
--- a/sound/soc/fsl/fsl_spdif.c
+++ b/sound/soc/fsl/fsl_spdif.c
@@ -324,6 +324,10 @@ static void spdif_write_channel_status(struct fsl_spdif_priv *spdif_priv)
 	regmap_write(regmap, REG_SPDIF_STCSCL, ch_status);
 
 	dev_dbg(&pdev->dev, "STCSCL: 0x%06x\n", ch_status);
+
+	/* Set outgoing validity off for non-audio */
+	regmap_update_bits(regmap, REG_SPDIF_SCR, SCR_VAL_MASK,
+			   (ctrl->ch_status[0] & IEC958_AES0_NONAUDIO) ? 0 : ~0);
 }
 
 /* Set SPDIF PhaseConfig register for rx clock */
-- 
1.7.9.5

