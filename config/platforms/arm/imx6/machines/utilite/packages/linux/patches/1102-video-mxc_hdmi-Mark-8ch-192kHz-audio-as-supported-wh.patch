From b6a3e46dcc0b68ae1b25ef577feaa6cc66e131d9 Mon Sep 17 00:00:00 2001
From: Rudi <r.ihle@s-t.de>
Date: Tue, 17 Nov 2015 19:42:18 +0100
Subject: [PATCH] video: mxc_hdmi: Mark 8ch/192kHz audio as supported when the
 sink is HD audio capable

---
 drivers/video/mxc/mxc_edid.c | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/drivers/video/mxc/mxc_edid.c b/drivers/video/mxc/mxc_edid.c
index 900c2fd..488873a 100644
--- a/drivers/video/mxc/mxc_edid.c
+++ b/drivers/video/mxc/mxc_edid.c
@@ -559,6 +559,14 @@ int mxc_edid_parse_ext_blk(unsigned char *edid,
 							DPRINTK("Sample Sizes            : %02x\n",
 								byte3 & 0x7);
 						}
+
+						/* HD-audio: pretend to support 192kHz/16bit in 8ch mode to
+						 * allow HD passthrough on sinks that report only 6ch LPCM */
+						if (audio_format == AUDIO_CODING_TYPE_MLP ||
+						    audio_format == AUDIO_CODING_TYPE_DTS_HD) {
+							cfg->sample_rates[3] |= 0x40;
+							cfg->sample_sizes[3] |= 0x01;
+						}
 					}
 					break;
 				}
-- 
1.9.1

