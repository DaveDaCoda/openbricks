#!/bin/sh

. config/path

CWD=`pwd`
cd $BUILD/DirectFB* && \
export DFB_MAJOR_VERSION=`sed -n 's/DIRECTFB_MAJOR_VERSION=\(.*\)/\1/p' configure.in` && \
export DFB_MINOR_VERSION=`sed -n 's/DIRECTFB_MINOR_VERSION=\(.*\)/\1/p' configure.in` && \
export DFB_MICRO_VERSION=`sed -n 's/DIRECTFB_MICRO_VERSION=\(.*\)/\1/p' configure.in` && \
export DFB_VERSION=$DFB_MAJOR_VERSION.$DFB_MINOR_VERSION.$DFB_MICRO_VERSION && \cd "$CWD"

mkdir -p $INSTALL/usr/lib/directfb-$DFB_VERSION/gfxdrivers
cp $BUILD/DirectFB*/src/.libs/*.so.?? $INSTALL/usr/lib || exit 1
cp $BUILD/DirectFB*/gfxdrivers/*/.libs/*.so $INSTALL/usr/lib/directfb-$DFB_VERSION/gfxdrivers || exit 1

mkdir -p $INSTALL/usr/lib/directfb-$DFB_VERSION/inputdrivers
cp $BUILD/DirectFB*/inputdrivers/keyboard/.libs/libdirectfb_keyboard.so $INSTALL/usr/lib/directfb-$DFB_VERSION/inputdrivers || exit 1

cp $BUILD/DirectFB*/inputdrivers/linux_input/.libs/libdirectfb_linux_input.so $INSTALL/usr/lib/directfb-$DFB_VERSION/inputdrivers || exit 1
cp $BUILD/DirectFB*/inputdrivers/lirc/.libs/libdirectfb_lirc.so $INSTALL/usr/lib/directfb-$DFB_VERSION/inputdrivers || exit 1

mkdir -p $INSTALL/usr/lib/directfb-$DFB_VERSION/systems
cp $BUILD/DirectFB*/src/core/fbdev/.libs/*.so $INSTALL/usr/lib/directfb-$DFB_VERSION/systems || exit 1
