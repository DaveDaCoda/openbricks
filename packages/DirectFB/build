#!/bin/sh

. config/path

$SCRIPTS/build uClibc || exit 1
$SCRIPTS/build linux || exit 1

CWD=`pwd`
UCBIN=`ls -d $ROOT/$BUILD/uClibc-*/build/usr/bin`
export UCLIBC_GCC_DLOPT="-Wl,--dynamic-linker,/lib/ld-uClibc.so.0" && \

cd $BUILD/DirectFB-* && \
CC=$UCBIN/gcc CFLAGS="-Os -isystem=`ls -d $ROOT/$BUILD/linux-*/include`" ./configure --prefix=/usr --without-static --enable-fbdev --disable-text --disable-sdl --disable-jpeg --disable-png --disable-gif --disable-freetype --disable-libmpeg3 --disable-video4linux --enable-linux-input --disable-mutouch --with-gfxdrivers=ati128,cle266,cyber5k,i810,matrox,neomagic,nsc,nvidia,radeon,savage,tdfx --disable-extra-warnings --disable-profiling --disable-debug --disable-trace --without-tools --host=i386-linux-gnu && \
make && \
strip src/.libs/*.so* gfxdrivers/*/.libs/*.so inputdrivers/*/.libs/*.so src/cor
e/fbdev/.libs/*.so && \
cd "$CWD" && \
exit 0

cd "$CWD"
exit 1
