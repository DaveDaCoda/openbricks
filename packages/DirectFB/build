#!/bin/sh

. config/options

$SCRIPTS/build toolchain || exit 1
$SCRIPTS/build linux || exit 1

CWD=`pwd`
export CFLAGS="-Os -isystem=`ls -d $ROOT/$BUILD/linux*/include`"
export CC=$TARGET_CC

cd $BUILD/DirectFB* && \
./configure --host=$TARGET_NAME \
            --prefix=/usr \
            --without-static \
            --enable-fbdev \
            --disable-text \
            --disable-sdl \
            --disable-jpeg \
            --disable-png \
            --disable-gif \
            --disable-freetype \
            --disable-libmpeg3 \
            --disable-video4linux \
            --enable-linux-input \
            --disable-mutouch \
            --with-gfxdrivers=tdfx \
            --disable-extra-warnings \
            --disable-profiling \
            --disable-debug \
            --disable-trace \
            --without-tools && \
make && \
$TARGET_STRIP src/.libs/*.so* \
              gfxdrivers/*/.libs/*.so \
              inputdrivers/*/.libs/*.so \
              src/core/fbdev/.libs/*.so && \
cd "$CWD" && \
exit 0

cd "$CWD"
exit 1
