#!/bin/sh

. config/path

$SCRIPTS/build uClibc || exit 1
$SCRIPTS/build alsa-lib || exit 1

CWD=`pwd`
UCBIN=`ls -d $ROOT/$BUILD/uClibc-*/build/usr/bin`

cd "`ls -d $BUILD/alsa-utils-*`" && \
CFLAGS="-Os -s" CC=$UCBIN/gcc ./configure --disable-dependency-tracking --with-alsa-prefix="`ls -d $ROOT/$BUILD/alsa-lib-*/src/.libs`" --with-alsa-inc-prefix="`ls -d $ROOT/$BUILD/alsa-lib-*/include`" && \
export UCLIBC_GCC_DLOPT="-Wl,--dynamic-linker,/lib/ld-uClibc.so.0" && \
make -C amixer && \
cd "$CWD" && \
exit 0

cd "$CWD"
exit 1
