#!/bin/sh

. config/options

$SCRIPTS/install ccache || exit 1
$SCRIPTS/install binutils || exit 1
$SCRIPTS/unpack uClibc || exit 1
if [ ! -e $TOOLCHAIN/$TARGET_NAME-uclibc/include ]; then
  ln -s $ROOT/$BUILD/uClibc*/include $TOOLCHAIN/$TARGET_NAME-uclibc/include
fi
CWD=`pwd`
unset INSTALL
export PATH=$ROOT/$TOOLCHAIN/bin:$PATH
export CC=$HOST_CC
export CFLAGS="-O2"
export LDFLAGS="-s"

cd $BUILD/gcc* && \
./configure --target=$TARGET_NAME-uclibc \
            --prefix=$ROOT/$TOOLCHAIN \
            --enable-languages=c \
            --disable-shared \
            --disable-nls && \
make && \
cd $CWD && \
exit 0

cd $CWD
exit 1
