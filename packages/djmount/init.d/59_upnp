#!/bin/sh
#
# mount UPnP VFS
#
# runlevels: geexbox, debug

# get options
test -f /etc/network || exit 1
. /etc/network

if test "$UPNP" = "yes" -a -f /usr/bin/djmount; then
  echo "### Mounting UPnP VFS ###"

  # Load FUSE kernel module
  modprobe fuse >/dev/null 2>&1

  # Build UPnP VFS directory
  mkdir -p /tmp/UPnP

  # Mount UPnP VFS (FUSE might be slooow to get registered, so sleep a bit)
  (
  sleep 3
  djmount -o iocharset='UTF-8' /tmp/UPnP -f >/dev/null 2>&1 &
  )&
fi

exit 0
