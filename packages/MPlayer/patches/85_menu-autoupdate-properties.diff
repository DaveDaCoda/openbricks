--- MPlayer-20060223/mplayer.c.orig	2006-04-07 23:48:17.000000000 +0800
+++ MPlayer-20060223/mplayer.c	2006-04-07 23:58:30.000000000 +0800
@@ -387,6 +387,7 @@
 #include "m_struct.h"
 #include "libmenu/menu.h"
 extern void vf_menu_pause_update(struct vf_instance_s* vf);
+extern void menu_stream_opened(int onlyhidden);
 extern vf_info_t vf_info_menu;
 static vf_info_t* libmenu_vfs[] = {
   &vf_info_menu,
@@ -2195,6 +2196,9 @@
   d_video = bg_demuxer->video;
   sh_video = d_video->sh;
   mp_msg(MSGT_DEMUXER,MSGL_INFO,"Background video should work ;)\n");
+#ifdef HAVE_MENU
+  menu_stream_opened(1);
+#endif
   break;
 }
 
@@ -2504,6 +2508,10 @@
 if(verbose) term_osd = 0;
 fflush(stdout);
 
+#ifdef HAVE_MENU
+menu_stream_opened(0);
+#endif
+
 #ifdef HAVE_NEW_GUI
    if ( use_gui )
     {
--- MPlayer-20060223/libmenu/menu.c.orig	2006-04-07 23:51:13.000000000 +0800
+++ MPlayer-20060223/libmenu/menu.c	2006-04-07 23:59:33.000000000 +0800
@@ -225,6 +225,7 @@
     return NULL;
   }
   m = calloc(1,sizeof(menu_t));
+  strncpy(m->name,name,sizeof(m->name));
   m->priv_st = &(menu_list[i].type->priv_st);
   m->priv = m_struct_copy(m->priv_st,menu_list[i].cfg);
   if(menu_list[i].type->open(m,menu_list[i].args))
--- MPlayer-20060223/libmenu/menu.h.orig	2006-04-07 23:51:18.000000000 +0800
+++ MPlayer-20060223/libmenu/menu.h	2006-04-07 23:57:22.000000000 +0800
@@ -12,6 +12,7 @@
   int show; // Draw it ?
   int cl; // Close request (user sent a close cmd or
   menu_t* parent;
+  char name[20];
 };
 
 typedef struct menu_info_s {
--- MPlayer-20060223/libmenu/vf_menu.c.orig	2006-04-07 23:52:40.000000000 +0800
+++ MPlayer-20060223/libmenu/vf_menu.c	2006-04-08 00:00:46.000000000 +0800
@@ -40,6 +40,12 @@
   int passthrough;
 };
 
+void menu_stream_opened(int onlyhidden) {
+  if ( (onlyhidden && !st_priv->current->show) || 
+         !strncmp("properties",st_priv->current->name,20) )
+    mp_input_queue_cmd(mp_input_parse_cmd("set_menu properties"));
+}
+
 static int put_image(struct vf_instance_s* vf, mp_image_t *mpi);
 
 static mp_image_t* alloc_mpi(int w, int h, uint32_t fmt) {
@@ -126,6 +132,10 @@
       printf("Failed to open menu '%s'\n",menu);
       priv->current = l;
       priv->current->show = 0;
+    } else if (!strcmp("properties",menu) && !strcmp(l->name,menu)) {
+      priv->current->show = l->show; 
+      priv->current->parent = l->parent; 
+      menu_close(l);
     } else {
       priv->current->show = 1;
       priv->current->parent = l;
