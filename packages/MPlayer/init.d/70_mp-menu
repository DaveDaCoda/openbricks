#!/bin/sh
#
# configure MPlayer's menu
#
# runlevels: geexbox, debug

echo "### Configuring MPlayer's menu ###"

# remove DVD from the menu if no dvd drive is available
test -e /dev/dvd || sed -i 's/.*DVD.*//' /etc/mplayer/menu.conf

# remove image viewer from the menu if fbi is not present
test -x /usr/bin/fbi || sed -i 's/.*set_menu\ view_img.*//' /etc/mplayer/menu.conf

# add partitions free space in menu
for i in `mount | sed -n 's%/dev/\([sh]d[a-z][0-9]\).*%\1%p'`; do
  MENU_DF="$MENU_DF <e name=\"$i\"/>"
done
[ -n "$MENU_DF" ] && sed -i "s%name=\"ip\"/>%name=\"ip\"/> $MENU_DF%" /etc/mplayer/menu.conf

exit 0
