#!/bin/sh

DIR=$1
[ -d "$DIR" ] || DIR=${DIR%/[^/]*}

for i in `cat /etc/file_ext`; do
  if [ -z "$EXTS" ]; then
    EXTS="$i"
  else
    EXTS="$EXTS\|$i"
  fi
done

find "$1" | grep -v /GEEXBOX/ | grep -i "\.\($EXTS\)\$" | sort > /tmp/playlist.pls
if [ -s /tmp/playlist.pls ]; then
  echo 'loadlist /tmp/playlist.pls' > /var/mp_control
  echo 'set_menu null' > /var/mp_control
else
  exit 1
fi
