#!/bin/sh

. config/path

CWD=`pwd`

cd `ls -d $BUILD/ncurses*/ncurses-host` && \
./configure && \
make -C progs transform.h && \
make -C progs tic && \
cd "$CWD" || exit 1

$SCRIPTS/build uClibc || exit 1

export CC="`ls $ROOT/$BUILD/uClibc*/build/usr/bin/gcc`"
export UCLIBC_GCC_DLOPT="-Wl,--dynamic-linker,/lib/ld-uClibc.so.0"
CWD=`pwd`

cd `ls -d $BUILD/ncurses*` && \
./configure --prefix=/usr --host=i386-linux-gnu --with-build-cc=`which gcc` --without-cxx --without-cxx-binding --without-ada --without-progs --with-shared --without-normal --without-debug --without-profile --without-termlib --without-dbmalloc --without-dmalloc --without-gpm --disable-rpath --disable-overwrite --enable-database --disable-big-core --enable-termcap --enable-getcap --disable-getcap-cache --disable-bsdpad --without-rcs-ids --enable-ext-funcs --disable-const --enable-no-padding --disable-sigwinch --disable-tcap-names --without-develop --disable-hard-tabs --disable-xmc-glitch --disable-hashmap --enable-safe-sprintf --disable-scroll-hints --disable-widec --disable-echo --disable-warnings --disable-assertions && \
make -C include CFLAGS="-Os" && \
make -C ncurses CFLAGS="-Os" && \
ar cru lib/libncurses.a obj_s/*.o && \
mkdir -p include/ncurses && \
ln -s ../curses.h include/ncurses/ncurses.h && \
ln -s ../term.h include/ncurses/term.h && \
cd "$CWD" && \
exit 0

cd "$CWD"
exit 1
