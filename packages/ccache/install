#!/bin/sh

. config/options

make -C $BUILD/ccache* install

if [ "$2" = toolchain ]; then
  CROSS_CC=$TARGET_CC-$GCC_VERSION
  rm -f $TARGET_CC
  echo "#!/bin/sh" >$TARGET_CC
  echo "$ROOT/$TOOLCHAIN/bin/ccache $CROSS_CC \"\$@\"" >>$TARGET_CC
  chmod +x $TARGET_CC
  # To avoid cache trashing
  DATE="`echo $GCC_VERSION | sed 's/\([0-9]\)/0\1/g' | sed 's/\.//g'`0000"
  touch -c -t $DATE $CROSS_CC
else
  echo "#!/bin/sh" >$HOST_CC
  echo "$ROOT/$TOOLCHAIN/bin/ccache $LOCAL_CC \"\$@\"" >>$HOST_CC
  chmod +x $HOST_CC
  echo "#!/bin/sh" >$HOST_CXX
  echo "$ROOT/$TOOLCHAIN/bin/ccache $LOCAL_CXX \"\$@\"" >>$HOST_CXX
  chmod +x $HOST_CXX
fi
