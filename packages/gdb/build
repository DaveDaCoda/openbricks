#!/bin/sh

. config/path

$SCRIPTS/build termcap || exit 1

export UCLIBC_GCC_DLOPT="-Wl,--dynamic-linker,/lib/ld-uClibc.so.0"
CWD=`pwd`
TERMCAP_DIR=`ls -d $ROOT/$BUILD/termcap-*`

cd "`ls -d $BUILD/gdb*`" && \
CC="`ls $ROOT/$BUILD/uClibc-*/build/usr/bin/gcc`" ./configure --disable-nls &&\
mv gdb/Makefile gdb/Makefile.old && \
cat gdb/Makefile.old | sed "s%TERMCAP =.*%TERMCAP = -L$TERMCAP_DIR -ltermcap%" > gdb/Makefile && \
make && \
cd "$CWD" && \
exit 0

cd "$CWD"
exit 1
