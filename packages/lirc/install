#!/bin/sh

. config/path
. $CONFIG/options

mkdir -p $INSTALL/etc
mkdir -p $INSTALL/usr/bin
mkdir -p "`ls -d $INSTALL/lib/modules/*`/misc"

cp $BUILD/lirc-*/daemons/lircd $INSTALL/usr/bin
cp $BUILD/lirc-*/drivers/lirc_dev/lirc_dev.o $BUILD/lirc-*/drivers/lirc_i2c/lirc_i2c.o $BUILD/lirc-*/drivers/lirc_gpio/lirc_gpio.o $BUILD/lirc-*/drivers/lirc_serial/lirc_serial.o $INSTALL/lib/modules/*/misc

case "$2" in 
  generator)
    mkdir -p $GENERATOR_NAME/lirc
    cp $PACKAGES/lirc/lircrc_* $GENERATOR_NAME/lirc
    cp $PACKAGES/lirc/lircd_* $GENERATOR_NAME/lirc
    cp $BUILD/lirc*/remotes/pinnacle_systems/lircd.conf.pctv $GENERATOR_NAME/lirc/lircd_pctv.conf
    cp $BUILD/lirc*/remotes/logitech/lircd.conf.logitech $GENERATOR_NAME/lirc/lircd_logitech.conf
    cp $BUILD/lirc*/remotes/hauppauge/lircd.conf.hauppauge $GENERATOR_NAME/lirc/lircd_hauppauge.conf
    cp $BUILD/lirc*/remotes/sigma_designs/lircd.conf.realmagic $GENERATOR_NAME/lirc/lircd_realmagic.conf
    cp $SOURCES/lirc/lircd.conf.leadtek $GENERATOR_NAME/lirc/lircd_leadtek.conf
    ;;

  installator)
    mkdir -p $INSTALL/etc/lirc
    cp $PACKAGES/lirc/lircrc_* $INSTALL/etc/lirc
    cp $PACKAGES/lirc/lircd_* $INSTALL/etc/lirc
    cp $BUILD/lirc*/remotes/pinnacle_systems/lircd.conf.pctv $INSTALL/etc/lirc/lircd_pctv.conf
    cp $BUILD/lirc*/remotes/logitech/lircd.conf.logitech $INSTALL/etc/lirc/lircd_logitech.conf
    cp $BUILD/lirc*/remotes/hauppauge/lircd.conf.hauppauge $INSTALL/etc/lirc/lircd_hauppauge.conf
    cp $BUILD/lirc*/remotes/sigma_designs/lircd.conf.realmagic $INSTALL/etc/lirc/lircd_realmagic.conf
    cp $SOURCES/lirc/lircd.conf.leadtek $INSTALL/etc/lirc/lircd_leadtek.conf
    echo "# Remote to Use (pctv/logitech/hauppauge/realmagic/leadtek)" > $INSTALL/etc/remote
    echo "REMOTE=$REMOTE" >> $INSTALL/etc/remote
    ;;

  *)
    cp $PACKAGES/lirc/lircrc_$REMOTE $INSTALL/etc/lircrc
    cp $PACKAGES/lirc/lircd_$REMOTE $INSTALL/etc/lircd
    case $REMOTE in
      pctv)
        cp $BUILD/lirc*/remotes/pinnacle_systems/lircd.conf.pctv $INSTALL/etc/lircd.conf
        ;;
      logitech)
        cp $BUILD/lirc*/remotes/logitech/lircd.conf.logitech $INSTALL/etc/lircd.conf
        ;;
      hauppauge)
        cp $BUILD/lirc*/remotes/hauppauge/lircd.conf.hauppauge $INSTALL/etc/lircd.conf
        ;;
      realmagic)
        cp $BUILD/lirc*/remotes/sigma_designs/lircd.conf.realmagic $INSTALL/etc/lircd.conf
        ;;
      leadtek)
        cp $SOURCES/lirc/lircd.conf.leadtek $INSTALL/etc/lircd.conf
        ;;
    esac
    ;;
esac
