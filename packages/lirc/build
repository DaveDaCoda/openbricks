#!/bin/sh

. config/path

$SCRIPTS/build uClibc || exit 1
$SCRIPTS/build libirman || exit 1


export UCLIBC_GCC_DLOPT="-Wl,--dynamic-linker,/lib/ld-uClibc.so.0"
CWD=`pwd`

cd "`ls -d $BUILD/lirc-*`" && \
CC="`ls $ROOT/$BUILD/uClibc-*/build/usr/bin/gcc`" LDFLAGS="-L`ls -d $ROOT/$BUILD/libirman*`" ./configure --host=i386-linux-gnu --disable-shared  --without-x --with-driver=any --with-port=0x3f8 --with-irq=4 --with-kerneldir="`ls -d $ROOT/$BUILD/linux-*`" && \
make CC="`ls $ROOT/$BUILD/uClibc-*/build/usr/bin/gcc`" && \
strip daemons/lircd && \
ln -sf tools lirc && \
cd "$CWD" && \
exit 0

cd "$CWD"
exit 1
