#!/bin/sh

. config/options

$SCRIPTS/build toolchain || exit 1
$SCRIPTS/build libirman || exit 1

CWD=`pwd`
export CC=$TARGET_CC
export LDFLAGS="-L`ls -d $ROOT/$BUILD/libirman*`"
export CROSS_COMPILE=$TARGET_PREFIX
export ARCH=$TARGET_ARCH

cd "`ls -d $BUILD/lirc*`" && \
./configure --host=$TARGET_NAME \
            --disable-shared \
            --without-x \
            --with-driver=any \
            --with-port=0x3f8 \
            --with-irq=4 \
            --with-kerneldir=$KERNEL && \
make && \
$TARGET_STRIP daemons/lircd && \
ln -sf tools lirc && \
cd "$CWD" && \
exit 0

cd "$CWD"
exit 1
